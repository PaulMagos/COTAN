% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geneSetEnrichment.R
\name{geneSetEnrichment}
\alias{geneSetEnrichment}
\title{geneSetEnrichment}
\usage{
geneSetEnrichment(clustersCoex, groupMarkers)
}
\arguments{
\item{clustersCoex}{the \code{data.frame} for the increased or decreased
expression of every gene in the cluster compared to the whole background}

\item{groupMarkers}{a named \code{list} of arrays of genes}
}
\value{
a \code{data.frame} with the cumulative score
}
\description{
This function returns a cumulative score of enrichment in a
cluster over a gene set
}
\details{
Calculates \eqn{\frac{1}{n}\sum_i(1-e^{-\theta X_i})}, where the
\eqn{X_i} are the positive values from \code{\link[=DEAOnClusters]{DEAOnClusters()}} and \eqn{\theta =
  -\frac{1}{0.1} \ln(0.25)}
}
\examples{
data("test.dataset")
objCOTAN <- automaticCOTANObjectCreation(raw = test.dataset,
                                         GEO = "S",
                                         sequencingMethod = "10X",
                                         sampleCondition = "Test",
                                         cores = 12,
                                         saveObj = FALSE,
                                         outDir = tempdir())
clusters <- cellsUniformClustering(objCOTAN, cores = 12,
                                   saveObj = FALSE,
                                   outDir = tempdir())
coexDF <- DEAOnClusters(objCOTAN, clusters = clusters)[["coex"]]
objCOTAN <- addClusterization(objCOTAN, clName = "clusters",
                              clusters = clusters, coexDF = coexDF)
groupMarkers <- list(G1 = c("g-000010", "g-000020", "g-000030"),
                     G2 = c("g-000300", "g-000330"),
                     G3 = c("g-000510", "g-000530", "g-000550", "g-000570", "g-000590"))
enrichment <- geneSetEnrichment(clustersCoex = coexDF,
                                groupMarkers = groupMarkers)

}
