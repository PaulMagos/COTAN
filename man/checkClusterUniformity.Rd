% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/checkClusterUniformity.R
\name{checkClusterUniformity}
\alias{checkClusterUniformity}
\title{checkClusterUniformity}
\usage{
checkClusterUniformity(
  objCOTAN,
  cluster,
  cells,
  cores = 1L,
  saveObj = TRUE,
  outDir = "."
)
}
\arguments{
\item{objCOTAN}{a \code{COTAN} object}

\item{cluster}{the tag of the cluster}

\item{cells}{the cells in the cluster}

\item{cores}{number of cores used}

\item{saveObj}{Boolean flag; when \code{TRUE} saves intermediate analyses and
plots to file}

\item{outDir}{an existing directory for the analysis output.}
}
\value{
an array of cells that need to be re-clustered or nothing
}
\description{
This function takes a \code{COTAN} object and a cells' cluster and
checks whether the latter is \strong{uniform} by GDI.
}
\details{
It runs \code{COTAN} to check whether the GDI is lower than \eqn{1.5} for
the \eqn{99\%} of the genes. If the GDI results to be too high, the cluster
is deemed \strong{non-uniform}
}
\examples{
data("raw.dataset")
objCOTAN <- automaticCOTANObjectCreation(raw = raw.dataset,
                                         GEO = "S",
                                         sequencingMethod = "10X",
                                         sampleCondition = "Test",
                                         cores = 12,
                                         saveObj = FALSE,
                                         outDir = tempdir())
clusters <- cellsUniformClustering(objCOTAN, cores = 12,
                                   saveObj = FALSE,
                                   outDir = tempdir())
cellsToCheck <- getCells(objCOTAN)[clusters \%in\% clusters[1]]
isUniform <- checkClusterUniformity(objCOTAN, cluster = clusters[1],
                                    cells = cellsToCheck, cores = 12,
                                    saveObj = FALSE, outDir = tempdir())

}
