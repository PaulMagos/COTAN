% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mergeUniformCellsClusters.R
\name{mergeUniformCellsClusters}
\alias{mergeUniformCellsClusters}
\title{mergeUniformCellsClusters}
\usage{
mergeUniformCellsClusters(
  objCOTAN,
  clusters = NULL,
  cores = 1,
  distance = "cosine",
  hclustMethod = "ward.D2",
  saveObj = FALSE,
  outDir = "."
)
}
\arguments{
\item{clusters}{The clusterization to merge. If not given the last available
clusterization will be used, as it is probably the most significant!}

\item{cores}{number cores used}

\item{distance}{type of distance to use (default is \code{cosine}, \code{euclidean} is
also available)}

\item{hclustMethod}{default is "ward.D2" but can be any method defined by
\code{\link[stats:hclust]{stats::hclust()}} function}

\item{saveObj}{Boolean flag; when \code{TRUE} saves intermediate analyses and
plots to file}

\item{outDir}{an existing directory for the analysis output.}

\item{obj}{a \code{COTAN} object}
}
\value{
the new clusterization
}
\description{
This function takes in input a \code{COTAN} object along with a
uniform clusterization and, through the \emph{cosine distance} and the \code{hclust},
checks if merging two leaf clusters will form a still uniform cluster
(this is done iteratively). All structures are saved on disk on request.
}
\details{
This function uses \code{\link[=checkClusterUniformity]{checkClusterUniformity()}} to check whether
merged clusters' uniformity
}
\examples{
data("raw.dataset")
objCOTAN <- automaticCOTANObjectCreation(raw = raw.dataset,
                                         GEO = "S",
                                         sequencingMethod = "10X",
                                         sampleCondition = "Test",
                                         cores = 12,
                                         saveObj = FALSE,
                                         outDir = tempdir())

clusters <- cellsUniformClustering(objCOTAN, cores = 12,
                                   saveObj = FALSE,
                                   outDir = tempdir())

mergedList <- mergeUniformCellsClusters(objCOTAN = obj,
                            clusters = clusters,
                            cores = 12,
                            distance = "cosine",
                            hclustMethod = "ward.D2",
                            saveObj = FALSE,
                            outDir = tempdir())
mergedClusters <- mergedList[["clusters"]]

}
